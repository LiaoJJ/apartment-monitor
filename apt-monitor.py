import time
from datetime import datetime
from abc import abstractmethod, ABC
import threading
import requests
from play_sound import play_sound
from send_an_email import send_email

# Configuration
SCS_ALERT_PRICE = 3300
LYNHAVEN_ALERT_PRICE = 3100
EMAIL_ALERT_ADDRESS = "XXX@gmail.com"
INTERVAL_TIME = 600

# HTTP Setting
scs_url = 'https://search.irvinecompanyapartments.com/multipleQueries'
scs_payload = '{"queries":[{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C3","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C3","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C3","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C5","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C5","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C5","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C9","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C9","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C9","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C11","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C11","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C11","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4295540_4","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4295540_4","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4295540_4","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C21D","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C21D","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C21D","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C28","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C28","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C28","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C30","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C30","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C30","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C32","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C32","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C32","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C36","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C36","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C36","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4422567_17","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4422567_17","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4422567_17","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4793545_4","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4793545_4","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4793545_4","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C53","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C53","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C53","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C55D","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C55D","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 11C55D","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C67","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C67","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND unitTypeCode: 22C67","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4793545_31","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4793545_31","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4793545_31","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitStartingPrice_asc","query":"","params":{"hitsPerPage":1,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4699269_21","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability_unitEarliestAvailable_asc","query":"","params":{"hitsPerPage":2,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4699269_21","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}},{"indexName":"prod_ica_unitAvailability","query":"","params":{"hitsPerPage":5,"attributesToHighlight":[],"filters":"(propertyCRMID:0x000000000000042f OR propertyCRMID:0x00000000000008d8 OR propertyCRMID:0x0000000000000460 OR propertyCRMID:0x0000000000000461 OR propertyCRMID:0x00000000000008a8 OR propertyCRMID:0x000000000000045f) AND floorplanUniqueID: 4699269_21","attributesToRetrieve":["floorplanName","unitMarketingName","featuredAmenity","floorplanUniqueID","floorplanCRMID","unitCRMID","unitTypeCode","propertyID","propertyAddress","buildingNumber","floorplanID","floorplanBath","floorplanBed","floorplanDeposit","unitID","unitFloor","unitSqFt","unitIsStudio","unitTypeName","unitAmenities","unitStartingPrice","unitEarliestAvailable","unitLeasePrice","unitConcessions","communityMarketingName","communityIDAEM","propertyZip","floorplanSqFt"]}}]}'
scs_headers = {'authority': 'search.irvinecompanyapartments.com',
               'accept': 'application/json, text/plain, */*',
               'accept-language': 'en-US,en;q=0.9,zh;q=0.8,zh-CN;q=0.7',
               'cache-control': 'no-cache',
               'content-type': 'application/json;charset=UTF-8',
               'origin': 'https://www.irvinecompanyapartments.com',
               'pragma': 'no-cache',
               'referer': 'https://www.irvinecompanyapartments.com/',
               'sec-ch-ua': '".Not/A)Brand";v="99", "Google Chrome";v="103", "Chromium";v="103"',
               'sec-ch-ua-mobile': '?0',
               'sec-ch-ua-platform': '"macOS"',
               'sec-fetch-dest': 'empty',
               'sec-fetch-mode': 'cors',
               'sec-fetch-site': 'same-site',
               'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36',
               'x-referer': 'https://www.irvinecompanyapartments.com/locations/northern-california/santa-clara/santa-clara-square/availability.html'}

lynhaven_url = "https://livelynhaven.com/floorplans/"
lynhaven_payload = 'action=available-units&building='
lynhaven_headers = {'Accept': '*/*',
                    'Accept-Language': 'en-US,en;q=0.9,zh;q=0.8,zh-CN;q=0.7',
                    'Cache-Control': 'no-cache',
                    'Connection': 'keep-alive',
                    'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
                    'Cookie': 'JonahLead=eyJyZWZlcnJlciI6Imdvb2dsZS5jb20iLCJyZWZlcnJlcl91cmxfcXVlcnlzdHJpbmciOm51bGwsImN1cnJlbnRfdXJsX3F1ZXJ5c3RyaW5nIjoidXRtX3NvdXJjZT1Hb29nbGVMb2NhbExpc3RpbmcmdXRtX21lZGl1bT1vcmdhbmljIiwicHJvcGVydHlfaWRfaW5zdGFsbGVkIjp0cnVlfQ%3D%3D; _ga=GA1.2.734990397.1653022463; _gcl_au=1.1.234958425.1653022465; _bcvm_vrid_6492243747324932241=704983039204449172T0EFA77FC90715E2D85550AE8EEE51C3241C520187FBD3D4719481ABC33FD43897B9B18092DB30D9D78B922D3A9C176C951648D747FC0E7030117064D86CB39BD; OptanonAlertBoxClosed=2022-05-20T04:54:40.221Z; _gid=GA1.2.1109921102.1657044792; PHPSESSID=qgcieh4vds34d98cb08gjv5n05; jonah_popdown=1654116075; _bcvm_vid_6492243747324932241=705026839938161781T35B348BD922A5F4B7DB9E40A47FB70A7090D6CD45AFAAA1D8AB4CFAFBEF0596EDC30B26C00FF07B2579543BB1B75AED1589AD8A1B38A2F3B8D8CDE18D270F82B; _gat_gtag_UA_28486633_68=1; _gat_gtag_UA_167356068_1=1; OptanonConsent=isIABGlobal=false&datestamp=Sat+Jul+09+2022+18%3A57%3A49+GMT-0700+(Pacific+Daylight+Time)&version=6.9.0&hosts=&landingPath=NotLandingPage&groups=C0001%3A1%2CC0003%3A1%2CSPD_BG%3A1%2CC0002%3A1%2CC0004%3A1&geolocation=US%3BCA&AwaitingReconsent=false; bc_pv_end=',
                    'Origin': 'https://livelynhaven.com',
                    'Pragma': 'no-cache',
                    'Referer': 'https://livelynhaven.com/floorplans/',
                    'Sec-Fetch-Dest': 'empty',
                    'Sec-Fetch-Mode': 'cors',
                    'Sec-Fetch-Site': 'same-origin',
                    'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36',
                    'X-Requested-With': 'XMLHttpRequest',
                    'sec-ch-ua': '".Not/A)Brand";v="99", "Google Chrome";v="103", "Chromium";v="103"',
                    'sec-ch-ua-mobile': '?0',
                    'sec-ch-ua-platform': '"macOS"'}


def alert(text):
    # play sound
    # send e-mail
    # play_sound()
    send_email("AptMonitor Alert", text, EMAIL_ALERT_ADDRESS)


class Strategy(ABC):
    @abstractmethod
    def execute(self, obj11):
        pass

    @abstractmethod
    def check(self):
        pass


class StrategySCSMinPrice(Strategy):
    def __init__(self):
        self.min = 5000

    def execute(self, obj11):
        self.min = min(self.min, obj11["unitStartingPrice"]["price"])

    def check(self):
        print("Min Price: {}".format(self.min))
        if self.min < SCS_ALERT_PRICE:
            alert("Santa Clara Square min price: {} < {}".format(self.min, SCS_ALERT_PRICE))


class StrategySCSStudioAvailability(Strategy):
    def __init__(self):
        self.hasStudio = False

    def execute(self, obj11):
        self.hasStudio = self.hasStudio or obj11["unitIsStudio"]
        # print("=====studio Available=====")

    def check(self):
        print("Studio: {}".format(self.hasStudio))
        if self.hasStudio:
            alert("Santa Clara Square studio is available")


class StrategyLynhavenMinPrice(Strategy):
    def __init__(self):
        self.min = 5000

    def execute(self, obj11):
        self.min = min(self.min, obj11["min_rent"])

    def check(self):
        print("Min Price: {}".format(self.min))
        if self.min < LYNHAVEN_ALERT_PRICE:
            alert("Lynhaven min price: {} < {}".format(self.min, SCS_ALERT_PRICE))


class StrategyLynhavenNew1B1BAvailable(Strategy):
    def __init__(self):
        self.prevNum1B1B = 0
        self.num1B1B = 0

    def execute(self, obj11):
        bed = obj11["bedroom"]
        bath = obj11["bathroom"]
        if bed == "1" and bath == "1":
            self.num1B1B += 1

    def check(self):
        print("num 1B1B: {}".format(self.num1B1B))
        if self.num1B1B != self.prevNum1B1B:
            alert("Lynhaven new 1b1b is available, prev number: {}, now number: {}".format(self.prevNum1B1B, self.num1B1B))
        self.prevNum1B1B = self.num1B1B
        self.num1B1B = 0


class AptMonitor:
    def runOnce(self):
        pass


class SCSAptMonitor(AptMonitor):
    def __init__(self, url, payload, headers, strategyList):
        self.url = url
        self.payload = payload
        self.headers = headers
        self.strategyList = strategyList

    def runOnce(self):
        r = requests.post(self.url, data=self.payload, headers=self.headers)
        resp = r.json()
        print()
        print("Santa Clara Square Monitor: {} HTTP Status: {}".format(datetime.now(), r.status_code))

        for obj in resp["results"]:
            for obj1 in obj["hits"]:
                for strategy in self.strategyList:
                    strategy.execute(obj1)

        for strategy in self.strategyList:
            strategy.check()


class LynhavenAptMonitor(AptMonitor):
    def __init__(self, url, payload, headers, strategyList):
        self.url = url
        self.payload = payload
        self.headers = headers
        self.strategyList = strategyList

    def runOnce(self):
        r = requests.post(self.url, data=self.payload, headers=self.headers)
        resp = r.json()
        print()
        print("Lynhaven Monitor: {} HTTP Status: {}".format(datetime.now(), r.status_code))

        for obj in resp:
            for strategy in self.strategyList:
                strategy.execute(obj)

        for strategy in self.strategyList:
            strategy.check()


scsStrategyList = [StrategySCSMinPrice(), StrategySCSStudioAvailability()]
scsMonitor = SCSAptMonitor(scs_url, scs_payload, scs_headers, scsStrategyList)

lynhavenStrategyList = [StrategyLynhavenMinPrice(), StrategyLynhavenNew1B1BAvailable()]
lynhavenMonitor = LynhavenAptMonitor(lynhaven_url, lynhaven_payload, lynhaven_headers, lynhavenStrategyList)

monitorList = [
    scsMonitor,
    lynhavenMonitor
]

while True:
    print()
    for monitor in monitorList:
        t1 = threading.Thread(target=monitor.runOnce)
        t1.start()

    time.sleep(INTERVAL_TIME)
